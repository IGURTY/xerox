<?php
/*
Copyright (c) 2024 Jumptec
Se quiser obter a licenÃ§a para esse produto, acesse https://www.jumptec.com.br
*/
 include(__DIR__ . '/../includes/configuracoes.php');   $v915cc18f4013=f42e3f489802e($_GET['tabela']);$vda131204afe6=f42e3f489802e($_REQUEST['nome_foto']);$v714ca9eb8722='../../imagens/'.$v915cc18f4013; $vf0e3e1311253=$_FILES['produto_foto_id']; $v37cb7708e7d1=f42e3f489802e($_REQUEST['registro_idtipo_foto']); $v0d98c302a3e0=f42e3f489802e($_REQUEST['registro_foto_id']); $v986239a66a5b=f42e3f489802e($_REQUEST['registro_id_produto']); $v30d84701afba=mysqli_query($connection, "SELECT id, largura, altura FROM tipo_foto;") or die(mysqli_error($connection));while($vc8b2d88e70d1=mysqli_fetch_array($v30d84701afba)){  $ve6007059d744[$vc8b2d88e70d1['id']]['w']=$vc8b2d88e70d1['largura']; $ve6007059d744[$vc8b2d88e70d1['id']]['h']=$vc8b2d88e70d1['altura'];} $va16d2280393c=0; if( (preg_match("/^image\/(pjpeg|jpeg|png|gif|bmp)$/", $vf0e3e1311253['type'][$va16d2280393c])) ){  $ve28c814c0a49=end( explode('.', $vf0e3e1311253['name'][$va16d2280393c] ) ); $v8588160fd3b0=ffc138eb4c54b( urlencode($vda131204afe6).'-'.rand(0,9999).date('-m-Y') ) . '.' . $ve28c814c0a49;  $vf0e3e1311253['name'][$va16d2280393c]=$v8588160fd3b0; $v665e4d9250a3=$v714ca9eb8722.'/'.$vf0e3e1311253['name'][$va16d2280393c];move_uploaded_file($vf0e3e1311253['tmp_name'][$va16d2280393c], $v665e4d9250a3);$vaa3e13f4d3fa=getimagesize($v665e4d9250a3);  if($ve28c814c0a49=='jpg' || $ve28c814c0a49=='jpeg'){ $v3da98ee90b0c=imagecreatefromjpeg($v665e4d9250a3);} else if($ve28c814c0a49=='png'){ $v3da98ee90b0c=imagecreatefrompng($v665e4d9250a3);} else if($ve28c814c0a49=='gif'){ $v3da98ee90b0c=imagecreatefromgif($v665e4d9250a3);}    $vb0add5590a49=$ve6007059d744[$v37cb7708e7d1]['w']; $vb306b5229083=$ve6007059d744[$v37cb7708e7d1]['h'];   if($vaa3e13f4d3fa[1]>$vb306b5229083){ $vd238541d39b5=$vb306b5229083;} else{ $vd238541d39b5=$vaa3e13f4d3fa[1];}  if($vaa3e13f4d3fa[0]>$vb0add5590a49 || $vaa3e13f4d3fa[1]>$vb306b5229083){ $vc045b5cb2ea9=($vaa3e13f4d3fa[0] * $vd238541d39b5) / $vaa3e13f4d3fa[1];} else{ $vc045b5cb2ea9=$vaa3e13f4d3fa[0];}  if($vc045b5cb2ea9<$vb0add5590a49){ $vb1c42d66c16f=($vb0add5590a49 - $vc045b5cb2ea9) / 2;} else{ $vb1c42d66c16f=0;}  if($vd238541d39b5<$vb306b5229083){ $vd05d044fd22f=($vb306b5229083 - $vd238541d39b5) / 2;} else{ $vd05d044fd22f=0;}  $v28c32980356d=imageistruecolor($v3da98ee90b0c);   if ( $v28c32980356d){ $vd2cb5030ba00=imagecreatetruecolor( $vb0add5590a49 ,$vb306b5229083 ); imagealphablending($vd2cb5030ba00, true); $v7d39dd432906=imagecolorallocatealpha( $vd2cb5030ba00, 255, 255, 255, 127); imagefill( $vd2cb5030ba00, 0, 0, $v7d39dd432906 ); imagesavealpha ( $vd2cb5030ba00 , true );} else{ $vd2cb5030ba00=imagecreate( $vb0add5590a49, $vb0add5590a49 ); imagealphablending( $vd2cb5030ba00, true ); $v7d39dd432906=imagecolorallocate( $vd2cb5030ba00, 255, 255, 255 ); imagefill( $vd2cb5030ba00, 0, 0, $v7d39dd432906 ); imagesavealpha( $vd2cb5030ba00,true ); imagealphablending( $vd2cb5030ba00, true );}  imagecopyresampled($vd2cb5030ba00, $v3da98ee90b0c, $vb1c42d66c16f, $vd05d044fd22f, 0, 0, $vc045b5cb2ea9, $vd238541d39b5, imagesx($v3da98ee90b0c), imagesy($v3da98ee90b0c) );  imagejpeg($vd2cb5030ba00, $v665e4d9250a3, 95);$vbbf113b74e54=mysqli_query($connection, "SELECT endereco FROM `foto` WHERE endereco LIKE '".$v8e54a50133ec['endereco']."'") or die(mysqli_error($connection)); $v6ce885ff1703=mysqli_num_rows($vbbf113b74e54); if($v6ce885ff1703==1){ $v8e54a50133ec=mysqli_fetch_array($vbbf113b74e54); if(!empty($v8e54a50133ec['endereco'])){  unlink($v714ca9eb8722.'/'.$v8e54a50133ec['endereco']);}}$vbbaf40473dcc="UPDATE foto SET endereco='".$vf0e3e1311253['name'][$va16d2280393c]."', idtipo_foto='".(int)$v37cb7708e7d1."' WHERE id='".(int)$v0d98c302a3e0."'"; $v3780add3f633=mysqli_query($connection, $vbbaf40473dcc) or die(mysqli_error($connection));} echo '<script>window.location.href="../telas/formulario.php?tabela='.$v915cc18f4013.'&acao=alterar&id='.$v986239a66a5b.'";</script>'; mysqli_close($connection);?>