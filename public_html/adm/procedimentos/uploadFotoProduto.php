<?php
/*
Copyright (c) 2024 Jumptec
Se quiser obter a licenÃ§a para esse produto, acesse https://www.jumptec.com.br
*/
 include(__DIR__ . '/../includes/configuracoes.php');   $v714ca9eb8722='../../imagens/produto/';  $v20e6dd169e57=f42e3f489802e($_GET['idproduto'], 'int');$vda131204afe6=strtolower(f42e3f489802e($_GET['nome']));$va6ae8ae6c998=array();  $v30d84701afba=mysqli_query($connection, "SELECT id, largura, altura FROM tipo_foto;");while($vc8b2d88e70d1=mysqli_fetch_array($v30d84701afba)){  $ve6007059d744[$vc8b2d88e70d1['id']]['w']=$vc8b2d88e70d1['largura']; $ve6007059d744[$vc8b2d88e70d1['id']]['h']=$vc8b2d88e70d1['altura'];}  if (!empty($_FILES)){      $v1fcb858e12f4=$_FILES['file']['name']; $v71478e5b0466=$_FILES['file']['type'];  $vac39d739cdfc=mysqli_query($connection, "SELECT id FROM foto WHERE idproduto=".$v20e6dd169e57); $v3a034aa7f79e=mysqli_num_rows($vac39d739cdfc); if($v3a034aa7f79e==0){ $v7ca1f02224d9=3; $v37cb7708e7d1[0]=3;$v37cb7708e7d1[1]=2;$v37cb7708e7d1[2]=1;} else{ $v7ca1f02224d9=2; $v37cb7708e7d1[0]=3;$v37cb7708e7d1[1]=2;}  if( (preg_match("/^image\/(pjpeg|jpeg|jpg|png|PNG|JPG|JPEG)$/", $v71478e5b0466)) ){ $ve28c814c0a49=strtolower(end(explode('.', $v1fcb858e12f4)));   for($va16d2280393c=0;$va16d2280393c<$v7ca1f02224d9;$va16d2280393c++){    $v8588160fd3b0=ffc138eb4c54b( urlencode($vda131204afe6).'-'.rand(999,999999).$va16d2280393c.date('-m-Y') ) . '.' . $ve28c814c0a49;    if($va16d2280393c==0){  $v2c3e295db3c6=$_FILES['file']['tmp_name'];  $v665e4d9250a3=$v714ca9eb8722.'/'.$v8588160fd3b0;  move_uploaded_file($v2c3e295db3c6, $v665e4d9250a3); } $vaa3e13f4d3fa=getimagesize($v665e4d9250a3);    if($ve28c814c0a49=='jpg' || $ve28c814c0a49=='jpeg'){  $v3da98ee90b0c=imagecreatefromjpeg($v665e4d9250a3); }  else if($ve28c814c0a49=='png'){  $v3da98ee90b0c=imagecreatefrompng($v665e4d9250a3); }  else if($ve28c814c0a49=='gif'){  $v3da98ee90b0c=imagecreatefromgif($v665e4d9250a3); }    $vb0add5590a49=$ve6007059d744[$v37cb7708e7d1[$va16d2280393c]]['w'];  $vb306b5229083=$ve6007059d744[$v37cb7708e7d1[$va16d2280393c]]['h'];    if($va16d2280393c>0){  $v665e4d9250a3=$v714ca9eb8722.'/'.$v8588160fd3b0; }    $v8cff01d37613=$vb0add5590a49 / $vb306b5229083;    $vdc252648b3df=$vaa3e13f4d3fa[0] / $vaa3e13f4d3fa[1];    if($vdc252648b3df>$v8cff01d37613){  $vc045b5cb2ea9=$vb0add5590a49;  $vd238541d39b5=($vaa3e13f4d3fa[1] * $vc045b5cb2ea9) / $vaa3e13f4d3fa[0]; }  else if($vdc252648b3df<$v8cff01d37613){  $vd238541d39b5=$vb306b5229083;  $vc045b5cb2ea9=($vaa3e13f4d3fa[0] * $vd238541d39b5) / $vaa3e13f4d3fa[1]; }  else{  $vc045b5cb2ea9=$vb0add5590a49;  $vd238541d39b5=$vb306b5229083; }    if($vc045b5cb2ea9<$vb0add5590a49){  $vb1c42d66c16f=($vb0add5590a49 - $vc045b5cb2ea9) / 2; }  else{  $vb1c42d66c16f=0; }    if($vd238541d39b5<$vb306b5229083){  $vd05d044fd22f=($vb306b5229083 - $vd238541d39b5) / 2; }  else{  $vd05d044fd22f=0; }    $v28c32980356d=imageistruecolor($v3da98ee90b0c);     if ( $v28c32980356d){  $vd2cb5030ba00=imagecreatetruecolor( $vb0add5590a49 ,$vb306b5229083 );  imagealphablending($vd2cb5030ba00, true);  $v7d39dd432906=imagecolorallocatealpha( $vd2cb5030ba00, 255, 255, 255, 127);  imagefill( $vd2cb5030ba00, 0, 0, $v7d39dd432906 );  imagesavealpha ( $vd2cb5030ba00 , true ); }  else{  $vd2cb5030ba00=imagecreate( $vb0add5590a49, $vb0add5590a49 );  imagealphablending( $vd2cb5030ba00, true );  $v7d39dd432906=imagecolorallocate( $vd2cb5030ba00, 255, 255, 255 );  imagefill( $vd2cb5030ba00, 0, 0, $v7d39dd432906 );  imagesavealpha( $vd2cb5030ba00,true );  imagealphablending( $vd2cb5030ba00, true ); }    imagecopyresampled($vd2cb5030ba00, $v3da98ee90b0c, $vb1c42d66c16f, $vd05d044fd22f, 0, 0, $vc045b5cb2ea9, $vd238541d39b5, imagesx($v3da98ee90b0c), imagesy($v3da98ee90b0c) );    imagejpeg($vd2cb5030ba00, $v665e4d9250a3, 98); $va6ae8ae6c998[$v37cb7708e7d1[$va16d2280393c]]=$v8588160fd3b0;}}ksort($va6ae8ae6c998); foreach ($va6ae8ae6c998 as $v0d98c302a3e0=>$va5b31f83c11c){ $vbbaf40473dcc="INSERT into foto (idtipo_foto, endereco, idproduto) VALUES ('".$v0d98c302a3e0."', '".$va5b31f83c11c."', '".(int)$v20e6dd169e57."')"; $v3780add3f633=mysqli_query($connection, $vbbaf40473dcc);}} mysqli_close($connection);?> 